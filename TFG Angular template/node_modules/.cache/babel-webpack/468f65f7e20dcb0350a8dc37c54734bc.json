{"ast":null,"code":"import _regeneratorRuntime from \"/home/juanma/Documentos/TecladoVirtual/TFG Angular template/node_modules/@babel/runtime/regenerator\";\n\n/*!\n* rete-context-menu-plugin v0.6.0-rc.1 \n* (c) 2020 Vitaliy Stoliarov \n* Released under the MIT license.\n*/\nfunction ___$insertStyle(css) {\n  if (!css) {\n    return;\n  }\n\n  if (typeof window === 'undefined') {\n    return;\n  }\n\n  var style = document.createElement('style');\n  style.setAttribute('type', 'text/css');\n  style.innerHTML = css;\n  document.head.appendChild(style);\n  return css;\n}\n\nimport { debounce, isFunction } from 'lodash-es';\nimport Vue from 'vue';\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction deepCopy(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nfunction createNode(_x, _x2) {\n  return _createNode.apply(this, arguments);\n}\n\nfunction _createNode() {\n  _createNode = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(component, _ref) {\n    var _ref$data, data, _ref$meta, meta, _ref$x, x, _ref$y, y, node;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _ref$data = _ref.data, data = _ref$data === void 0 ? {} : _ref$data, _ref$meta = _ref.meta, meta = _ref$meta === void 0 ? {} : _ref$meta, _ref$x = _ref.x, x = _ref$x === void 0 ? 0 : _ref$x, _ref$y = _ref.y, y = _ref$y === void 0 ? 0 : _ref$y;\n            _context.next = 3;\n            return component.createNode(deepCopy(data));\n\n          case 3:\n            node = _context.sent;\n            node.meta = Object.assign(deepCopy(meta), node.meta);\n            node.position[0] = x;\n            node.position[1] = y;\n            return _context.abrupt(\"return\", node);\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n  return _createNode.apply(this, arguments);\n}\n\nfunction traverse(items, callback) {\n  var path = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  if (_typeof(items) !== 'object') return;\n  Object.keys(items).map(function (key) {\n    if (typeof items[key] === 'function') callback(key, items[key], path);else traverse(items[key], callback, [].concat(_toConsumableArray(path), [key]));\n  });\n}\n\nfunction fitViewport(_ref2, element) {\n  var _ref3 = _slicedToArray(_ref2, 2),\n      x = _ref3[0],\n      y = _ref3[1];\n\n  return [Math.min(x, window.innerWidth - element.clientWidth), Math.min(y, window.innerHeight - element.clientHeight)];\n}\n\nvar hideMixin = function hideMixin(hideMethod) {\n  return {\n    props: {\n      delay: {\n        type: Number,\n        required: true\n      }\n    },\n    data: function data() {\n      return {\n        timeoutHide: function timeoutHide() {}\n      };\n    },\n    methods: {\n      cancelHide: function cancelHide() {\n        var hide = this.timeoutHide;\n        if (hide && hide.cancel) this.timeoutHide.cancel();\n      }\n    },\n    mounted: function mounted() {\n      this.timeoutHide = debounce(this[hideMethod], this.delay);\n    }\n  };\n}; //\n\n\nvar script = {\n  name: 'Item',\n  mixins: [hideMixin('hideSubitems')],\n  props: {\n    item: Object,\n    args: Object\n  },\n  data: function data() {\n    return {\n      visibleSubitems: false\n    };\n  },\n  computed: {\n    hasSubitems: function hasSubitems() {\n      return this.item.subitems;\n    }\n  },\n  methods: {\n    showSubitems: function showSubitems() {\n      this.visibleSubitems = true;\n      this.cancelHide();\n    },\n    hideSubitems: function hideSubitems() {\n      this.visibleSubitems = false;\n    },\n    onClick: function onClick(e) {\n      e.stopPropagation();\n      if (this.item.onClick) this.item.onClick(this.args);\n      this.$root.$emit('hide');\n    }\n  }\n};\n/* script */\n\nvar __vue_script__ = script;\n/* template */\n\nvar __vue_render__ = function __vue_render__() {\n  var _vm = this;\n\n  var _h = _vm.$createElement;\n\n  var _c = _vm._self._c || _h;\n\n  return _c(\"div\", {\n    staticClass: \"item\",\n    class: {\n      hasSubitems: _vm.hasSubitems\n    },\n    on: {\n      click: function click($event) {\n        _vm.onClick($event);\n      },\n      mouseover: function mouseover($event) {\n        _vm.showSubitems();\n      },\n      mouseleave: function mouseleave($event) {\n        _vm.timeoutHide();\n      }\n    }\n  }, [_vm._v(_vm._s(_vm.item.title)), _c(\"div\", {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: _vm.hasSubitems && this.visibleSubitems,\n      expression: \"hasSubitems && this.visibleSubitems\"\n    }],\n    staticClass: \"subitems\"\n  }, _vm._l(_vm.item.subitems, function (subitem) {\n    return _c(\"Item\", {\n      key: subitem.title,\n      attrs: {\n        item: subitem,\n        args: _vm.args,\n        delay: _vm.delay\n      }\n    });\n  }))]);\n};\n\nvar __vue_staticRenderFns__ = [];\n__vue_render__._withStripped = true;\n/* style */\n\nvar __vue_inject_styles__ = function __vue_inject_styles__(inject) {\n  if (!inject) return;\n  inject(\"data-v-99007bda_0\", {\n    source: \"\\n@charset \\\"UTF-8\\\";\\n.item[data-v-99007bda], .item .subitems .subitem[data-v-99007bda] {\\n  color: #fff;\\n  padding: 4px;\\n  border-bottom: 1px solid rgba(69, 103, 255, 0.8);\\n  background-color: rgba(110, 136, 255, 0.8);\\n  cursor: pointer;\\n  width: 100%;\\n  position: relative;\\n}\\n.item[data-v-99007bda]:first-child, .item .subitems .subitem[data-v-99007bda]:first-child {\\n    border-top-left-radius: 5px;\\n    border-top-right-radius: 5px;\\n}\\n.item[data-v-99007bda]:last-child, .item .subitems .subitem[data-v-99007bda]:last-child {\\n    border-bottom-left-radius: 5px;\\n    border-bottom-right-radius: 5px;\\n}\\n.item[data-v-99007bda]:hover, .item .subitems .subitem[data-v-99007bda]:hover {\\n    background-color: rgba(130, 153, 255, 0.8);\\n}\\n.hasSubitems.item[data-v-99007bda]:after, .item .subitems .hasSubitems.subitem[data-v-99007bda]:after {\\n  content: '►';\\n  position: absolute;\\n  opacity: 0.6;\\n  right: 5px;\\n  top: 5px;\\n}\\n.item .subitems[data-v-99007bda], .item .subitems .subitem .subitems[data-v-99007bda] {\\n  position: absolute;\\n  top: 0;\\n  left: 100%;\\n  width: 120px;\\n}\\n\\n/*# sourceMappingURL=Item.vue.map */\",\n    map: {\n      \"version\": 3,\n      \"sources\": [\"Item.vue\", \"/home/travis/build/retejs/context-menu-plugin/src/menu/Item.vue\"],\n      \"names\": [],\n      \"mappings\": \";AAAA,iBAAiB;ACyDjB;EDvDE,YAAY;EACZ,aAAa;EACb,iDAAiD;EACjD,2CAA2C;EAC3C,gBAAgB;EAChB,YAAY;EACZ,mBAAmB;CAAE;ACiDvB;ID/CI,4BAA4B;IAC5B,6BAA6B;CAAE;AC8CnC;ID5CI,+BAA+B;IAC/B,gCAAgC;CAAE;AC2CtC;IDzCI,2CAA2C;CAAE;AC2CjD;EACA,aAAA;EACA,mBAAA;EACA,aAAA;EACA,WAAA;EACA,SAAA;CAAA;AAPA;EASA,mBAAA;EACA,OAAA;EACA,WAAA;EACA,aAAA;CAEA;;ADxCA,oCAAoC\",\n      \"file\": \"Item.vue\",\n      \"sourcesContent\": [\"@charset \\\"UTF-8\\\";\\n.item, .item .subitems .subitem {\\n  color: #fff;\\n  padding: 4px;\\n  border-bottom: 1px solid rgba(69, 103, 255, 0.8);\\n  background-color: rgba(110, 136, 255, 0.8);\\n  cursor: pointer;\\n  width: 100%;\\n  position: relative; }\\n  .item:first-child, .item .subitems .subitem:first-child {\\n    border-top-left-radius: 5px;\\n    border-top-right-radius: 5px; }\\n  .item:last-child, .item .subitems .subitem:last-child {\\n    border-bottom-left-radius: 5px;\\n    border-bottom-right-radius: 5px; }\\n  .item:hover, .item .subitems .subitem:hover {\\n    background-color: rgba(130, 153, 255, 0.8); }\\n\\n.hasSubitems.item:after, .item .subitems .hasSubitems.subitem:after {\\n  content: '►';\\n  position: absolute;\\n  opacity: 0.6;\\n  right: 5px;\\n  top: 5px; }\\n\\n.item .subitems, .item .subitems .subitem .subitems {\\n  position: absolute;\\n  top: 0;\\n  left: 100%;\\n  width: 120px; }\\n\\n/*# sourceMappingURL=Item.vue.map */\", null]\n    },\n    media: undefined\n  });\n};\n/* scoped */\n\n\nvar __vue_scope_id__ = \"data-v-99007bda\";\n/* module identifier */\n\nvar __vue_module_identifier__ = undefined;\n/* functional template */\n\nvar __vue_is_functional_template__ = false;\n/* component normalizer */\n\nfunction __vue_normalize__(template, style, script$$1, scope, functional, moduleIdentifier, createInjector, createInjectorSSR) {\n  var component = (typeof script$$1 === 'function' ? script$$1.options : script$$1) || {}; // For security concerns, we use only base name in production mode.\n\n  component.__file = \"/home/travis/build/retejs/context-menu-plugin/src/menu/Item.vue\";\n\n  if (!component.render) {\n    component.render = template.render;\n    component.staticRenderFns = template.staticRenderFns;\n    component._compiled = true;\n    if (functional) component.functional = true;\n  }\n\n  component._scopeId = scope;\n  {\n    var hook;\n\n    if (style) {\n      hook = function hook(context) {\n        style.call(this, createInjector(context));\n      };\n    }\n\n    if (hook !== undefined) {\n      if (component.functional) {\n        // register for functional component in vue file\n        var originalRender = component.render;\n\n        component.render = function renderWithStyleInjection(h, context) {\n          hook.call(context);\n          return originalRender(h, context);\n        };\n      } else {\n        // inject component registration as beforeCreate hook\n        var existing = component.beforeCreate;\n        component.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n      }\n    }\n  }\n  return component;\n}\n/* style inject */\n\n\nfunction __vue_create_injector__() {\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var styles = __vue_create_injector__.styles || (__vue_create_injector__.styles = {});\n  var isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\\\b/.test(navigator.userAgent.toLowerCase());\n  return function addStyle(id, css) {\n    if (document.querySelector('style[data-vue-ssr-id~=\"' + id + '\"]')) return; // SSR styles are present.\n\n    var group = isOldIE ? css.media || 'default' : id;\n    var style = styles[group] || (styles[group] = {\n      ids: [],\n      parts: [],\n      element: undefined\n    });\n\n    if (!style.ids.includes(id)) {\n      var code = css.source;\n      var _index = style.ids.length;\n      style.ids.push(id);\n\n      if (isOldIE) {\n        style.element = style.element || document.querySelector('style[data-group=' + group + ']');\n      }\n\n      if (!style.element) {\n        var el = style.element = document.createElement('style');\n        el.type = 'text/css';\n        if (css.media) el.setAttribute('media', css.media);\n\n        if (isOldIE) {\n          el.setAttribute('data-group', group);\n          el.setAttribute('data-next-index', '0');\n        }\n\n        head.appendChild(el);\n      }\n\n      if (isOldIE) {\n        _index = parseInt(style.element.getAttribute('data-next-index'));\n        style.element.setAttribute('data-next-index', _index + 1);\n      }\n\n      if (style.element.styleSheet) {\n        style.parts.push(code);\n        style.element.styleSheet.cssText = style.parts.filter(Boolean).join('\\n');\n      } else {\n        var textNode = document.createTextNode(code);\n        var nodes = style.element.childNodes;\n        if (nodes[_index]) style.element.removeChild(nodes[_index]);\n        if (nodes.length) style.element.insertBefore(textNode, nodes[_index]);else style.element.appendChild(textNode);\n      }\n    }\n  };\n}\n/* style inject SSR */\n\n\nvar Item = __vue_normalize__({\n  render: __vue_render__,\n  staticRenderFns: __vue_staticRenderFns__\n}, __vue_inject_styles__, __vue_script__, __vue_scope_id__, __vue_is_functional_template__, __vue_module_identifier__, __vue_create_injector__, undefined); //\n//\n//\n//\n//\n\n\nvar script$1 = {\n  props: ['value', 'search'],\n  watch: {\n    value: function value() {\n      this.$emit('search', this.value);\n    }\n  }\n};\n/* script */\n\nvar __vue_script__$1 = script$1;\n/* template */\n\nvar __vue_render__$1 = function __vue_render__$1() {\n  var _vm = this;\n\n  var _h = _vm.$createElement;\n\n  var _c = _vm._self._c || _h;\n\n  return _c(\"div\", {\n    staticClass: \"search\"\n  }, [_c(\"input\", {\n    directives: [{\n      name: \"model\",\n      rawName: \"v-model\",\n      value: _vm.value,\n      expression: \"value\"\n    }],\n    domProps: {\n      value: _vm.value\n    },\n    on: {\n      input: function input($event) {\n        if ($event.target.composing) {\n          return;\n        }\n\n        _vm.value = $event.target.value;\n      }\n    }\n  })]);\n};\n\nvar __vue_staticRenderFns__$1 = [];\n__vue_render__$1._withStripped = true;\n/* style */\n\nvar __vue_inject_styles__$1 = function __vue_inject_styles__$1(inject) {\n  if (!inject) return;\n  inject(\"data-v-5cbfea22_0\", {\n    source: \"\\n.search input[data-v-5cbfea22] {\\n  color: white;\\n  padding: 1px 8px;\\n  border: 1px solid white;\\n  border-radius: 10px;\\n  font-size: 16px;\\n  font-family: serif;\\n  width: 100%;\\n  box-sizing: border-box;\\n  background: transparent;\\n}\\n\\n/*# sourceMappingURL=Search.vue.map */\",\n    map: {\n      \"version\": 3,\n      \"sources\": [\"/home/travis/build/retejs/context-menu-plugin/src/menu/Search.vue\", \"Search.vue\"],\n      \"names\": [],\n      \"mappings\": \";AAkBA;EAEA,aAAA;EACA,iBAAA;EACA,wBAAA;EACA,oBAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,uBAAA;EACA,wBAAA;CAAA;;ACjBA,sCAAsC\",\n      \"file\": \"Search.vue\",\n      \"sourcesContent\": [null, \".search input {\\n  color: white;\\n  padding: 1px 8px;\\n  border: 1px solid white;\\n  border-radius: 10px;\\n  font-size: 16px;\\n  font-family: serif;\\n  width: 100%;\\n  box-sizing: border-box;\\n  background: transparent; }\\n\\n/*# sourceMappingURL=Search.vue.map */\"]\n    },\n    media: undefined\n  });\n};\n/* scoped */\n\n\nvar __vue_scope_id__$1 = \"data-v-5cbfea22\";\n/* module identifier */\n\nvar __vue_module_identifier__$1 = undefined;\n/* functional template */\n\nvar __vue_is_functional_template__$1 = false;\n/* component normalizer */\n\nfunction __vue_normalize__$1(template, style, script, scope, functional, moduleIdentifier, createInjector, createInjectorSSR) {\n  var component = (typeof script === 'function' ? script.options : script) || {}; // For security concerns, we use only base name in production mode.\n\n  component.__file = \"/home/travis/build/retejs/context-menu-plugin/src/menu/Search.vue\";\n\n  if (!component.render) {\n    component.render = template.render;\n    component.staticRenderFns = template.staticRenderFns;\n    component._compiled = true;\n    if (functional) component.functional = true;\n  }\n\n  component._scopeId = scope;\n  {\n    var hook;\n\n    if (style) {\n      hook = function hook(context) {\n        style.call(this, createInjector(context));\n      };\n    }\n\n    if (hook !== undefined) {\n      if (component.functional) {\n        // register for functional component in vue file\n        var originalRender = component.render;\n\n        component.render = function renderWithStyleInjection(h, context) {\n          hook.call(context);\n          return originalRender(h, context);\n        };\n      } else {\n        // inject component registration as beforeCreate hook\n        var existing = component.beforeCreate;\n        component.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n      }\n    }\n  }\n  return component;\n}\n/* style inject */\n\n\nfunction __vue_create_injector__$1() {\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var styles = __vue_create_injector__$1.styles || (__vue_create_injector__$1.styles = {});\n  var isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\\\b/.test(navigator.userAgent.toLowerCase());\n  return function addStyle(id, css) {\n    if (document.querySelector('style[data-vue-ssr-id~=\"' + id + '\"]')) return; // SSR styles are present.\n\n    var group = isOldIE ? css.media || 'default' : id;\n    var style = styles[group] || (styles[group] = {\n      ids: [],\n      parts: [],\n      element: undefined\n    });\n\n    if (!style.ids.includes(id)) {\n      var code = css.source;\n      var _index2 = style.ids.length;\n      style.ids.push(id);\n\n      if (isOldIE) {\n        style.element = style.element || document.querySelector('style[data-group=' + group + ']');\n      }\n\n      if (!style.element) {\n        var el = style.element = document.createElement('style');\n        el.type = 'text/css';\n        if (css.media) el.setAttribute('media', css.media);\n\n        if (isOldIE) {\n          el.setAttribute('data-group', group);\n          el.setAttribute('data-next-index', '0');\n        }\n\n        head.appendChild(el);\n      }\n\n      if (isOldIE) {\n        _index2 = parseInt(style.element.getAttribute('data-next-index'));\n        style.element.setAttribute('data-next-index', _index2 + 1);\n      }\n\n      if (style.element.styleSheet) {\n        style.parts.push(code);\n        style.element.styleSheet.cssText = style.parts.filter(Boolean).join('\\n');\n      } else {\n        var textNode = document.createTextNode(code);\n        var nodes = style.element.childNodes;\n        if (nodes[_index2]) style.element.removeChild(nodes[_index2]);\n        if (nodes.length) style.element.insertBefore(textNode, nodes[_index2]);else style.element.appendChild(textNode);\n      }\n    }\n  };\n}\n/* style inject SSR */\n\n\nvar Search = __vue_normalize__$1({\n  render: __vue_render__$1,\n  staticRenderFns: __vue_staticRenderFns__$1\n}, __vue_inject_styles__$1, __vue_script__$1, __vue_scope_id__$1, __vue_is_functional_template__$1, __vue_module_identifier__$1, __vue_create_injector__$1, undefined);\n\nvar script$2 = {\n  props: {\n    searchBar: Boolean,\n    searchKeep: Function\n  },\n  mixins: [hideMixin('hide')],\n  data: function data() {\n    return {\n      x: 0,\n      y: 0,\n      visible: false,\n      args: {},\n      filter: '',\n      items: []\n    };\n  },\n  computed: {\n    style: function style() {\n      return {\n        top: this.y + 'px',\n        left: this.x + 'px'\n      };\n    },\n    filtered: function filtered() {\n      var _this = this;\n\n      if (!this.filter) return this.items;\n      var regex = new RegExp(this.filter, 'i');\n      return this.extractLeafs(this.items).filter(function (_ref) {\n        var title = _ref.title;\n        return _this.searchKeep(title) || title.match(regex);\n      });\n    }\n  },\n  methods: {\n    extractLeafs: function extractLeafs(items) {\n      var _this2 = this;\n\n      if (!items) return [];\n      var leafs = [];\n      items.map(function (item) {\n        if (!item.subitems) leafs.push(item);\n        leafs.push.apply(leafs, _toConsumableArray(_this2.extractLeafs(item.subitems)));\n      });\n      return leafs;\n    },\n    onSearch: function onSearch(e) {\n      this.filter = e;\n    },\n    show: function show(x, y) {\n      var args = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      this.visible = true;\n      this.x = x;\n      this.y = y;\n      this.args = args;\n      this.cancelHide();\n    },\n    hide: function hide() {\n      this.visible = false;\n    },\n    additem: function additem(title, onClick) {\n      var path = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n      var items = this.items;\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        var _loop = function _loop() {\n          var level = _step.value;\n          var exist = items.find(function (i) {\n            return i.title === level;\n          });\n\n          if (!exist) {\n            exist = {\n              title: level,\n              subitems: []\n            };\n            items.push(exist);\n          }\n\n          items = exist.subitems || (exist.subitems = []);\n        };\n\n        for (var _iterator = path[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          _loop();\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      items.push({\n        title: title,\n        onClick: onClick\n      });\n    }\n  },\n  updated: function updated() {\n    if (this.$refs.menu) {\n      var _fitViewport = fitViewport([this.x, this.y], this.$refs.menu);\n\n      var _fitViewport2 = _slicedToArray(_fitViewport, 2);\n\n      this.x = _fitViewport2[0];\n      this.y = _fitViewport2[1];\n    }\n  },\n  mounted: function mounted() {\n    this.$root.$on('show', this.show);\n    this.$root.$on('hide', this.hide);\n    this.$root.$on('additem', this.additem);\n  },\n  components: {\n    Item: Item,\n    Search: Search\n  }\n};\n/* script */\n\nvar __vue_script__$2 = script$2;\n/* template */\n\nvar __vue_render__$2 = function __vue_render__$2() {\n  var _vm = this;\n\n  var _h = _vm.$createElement;\n\n  var _c = _vm._self._c || _h;\n\n  return _vm.visible ? _c(\"div\", {\n    ref: \"menu\",\n    staticClass: \"context-menu\",\n    style: _vm.style,\n    on: {\n      mouseleave: function mouseleave($event) {\n        _vm.timeoutHide();\n      },\n      mouseover: function mouseover($event) {\n        _vm.cancelHide();\n      },\n      contextmenu: function contextmenu($event) {\n        $event.preventDefault();\n      },\n      wheel: function wheel($event) {\n        $event.stopPropagation();\n      }\n    }\n  }, [_vm.searchBar ? _c(\"Search\", {\n    on: {\n      search: _vm.onSearch\n    },\n    model: {\n      value: _vm.filter,\n      callback: function callback($$v) {\n        _vm.filter = $$v;\n      },\n      expression: \"filter\"\n    }\n  }) : _vm._e(), _vm._l(_vm.filtered, function (item) {\n    return _c(\"Item\", {\n      key: item.title,\n      attrs: {\n        item: item,\n        args: _vm.args,\n        delay: _vm.delay / 2\n      }\n    });\n  })], 2) : _vm._e();\n};\n\nvar __vue_staticRenderFns__$2 = [];\n__vue_render__$2._withStripped = true;\n/* style */\n\nvar __vue_inject_styles__$2 = function __vue_inject_styles__$2(inject) {\n  if (!inject) return;\n  inject(\"data-v-3b99e9c8_0\", {\n    source: \"\\n.item[data-v-3b99e9c8], .context-menu .search[data-v-3b99e9c8] {\\n  color: #fff;\\n  padding: 4px;\\n  border-bottom: 1px solid rgba(69, 103, 255, 0.8);\\n  background-color: rgba(110, 136, 255, 0.8);\\n  cursor: pointer;\\n  width: 100%;\\n  position: relative;\\n}\\n.item[data-v-3b99e9c8]:first-child, .context-menu .search[data-v-3b99e9c8]:first-child {\\n    border-top-left-radius: 5px;\\n    border-top-right-radius: 5px;\\n}\\n.item[data-v-3b99e9c8]:last-child, .context-menu .search[data-v-3b99e9c8]:last-child {\\n    border-bottom-left-radius: 5px;\\n    border-bottom-right-radius: 5px;\\n}\\n.item[data-v-3b99e9c8]:hover, .context-menu .search[data-v-3b99e9c8]:hover {\\n    background-color: rgba(130, 153, 255, 0.8);\\n}\\n.context-menu[data-v-3b99e9c8] {\\n  left: 0;\\n  top: 0;\\n  position: fixed;\\n  padding: 10px;\\n  width: 120px;\\n  margin-top: -20px;\\n  margin-left: -60px;\\n}\\n\\n/*# sourceMappingURL=Menu.vue.map */\",\n    map: {\n      \"version\": 3,\n      \"sources\": [\"Menu.vue\", \"/home/travis/build/retejs/context-menu-plugin/src/menu/Menu.vue\"],\n      \"names\": [],\n      \"mappings\": \";AAAA;EACE,YAAY;EACZ,aAAa;EACb,iDAAiD;EACjD,2CAA2C;EAC3C,gBAAgB;EAChB,YAAY;EACZ,mBAAmB;CAAE;AACrB;IACE,4BAA4B;IAC5B,6BAA6B;CAAE;AACjC;IACE,+BAA+B;IAC/B,gCAAgC;CAAE;AACpC;IACE,2CAA2C;CAAE;ACwGjD;EACA,QAAA;EACA,OAAA;EACA,gBAAA;EACA,cAAA;EACA,aAAA;EACA,kBAAA;EACA,mBAAA;CAEA;;ADtGA,oCAAoC\",\n      \"file\": \"Menu.vue\",\n      \"sourcesContent\": [\".item, .context-menu .search {\\n  color: #fff;\\n  padding: 4px;\\n  border-bottom: 1px solid rgba(69, 103, 255, 0.8);\\n  background-color: rgba(110, 136, 255, 0.8);\\n  cursor: pointer;\\n  width: 100%;\\n  position: relative; }\\n  .item:first-child, .context-menu .search:first-child {\\n    border-top-left-radius: 5px;\\n    border-top-right-radius: 5px; }\\n  .item:last-child, .context-menu .search:last-child {\\n    border-bottom-left-radius: 5px;\\n    border-bottom-right-radius: 5px; }\\n  .item:hover, .context-menu .search:hover {\\n    background-color: rgba(130, 153, 255, 0.8); }\\n\\n.context-menu {\\n  left: 0;\\n  top: 0;\\n  position: fixed;\\n  padding: 10px;\\n  width: 120px;\\n  margin-top: -20px;\\n  margin-left: -60px; }\\n\\n/*# sourceMappingURL=Menu.vue.map */\", null]\n    },\n    media: undefined\n  });\n};\n/* scoped */\n\n\nvar __vue_scope_id__$2 = \"data-v-3b99e9c8\";\n/* module identifier */\n\nvar __vue_module_identifier__$2 = undefined;\n/* functional template */\n\nvar __vue_is_functional_template__$2 = false;\n/* component normalizer */\n\nfunction __vue_normalize__$2(template, style, script, scope, functional, moduleIdentifier, createInjector, createInjectorSSR) {\n  var component = (typeof script === 'function' ? script.options : script) || {}; // For security concerns, we use only base name in production mode.\n\n  component.__file = \"/home/travis/build/retejs/context-menu-plugin/src/menu/Menu.vue\";\n\n  if (!component.render) {\n    component.render = template.render;\n    component.staticRenderFns = template.staticRenderFns;\n    component._compiled = true;\n    if (functional) component.functional = true;\n  }\n\n  component._scopeId = scope;\n  {\n    var hook;\n\n    if (style) {\n      hook = function hook(context) {\n        style.call(this, createInjector(context));\n      };\n    }\n\n    if (hook !== undefined) {\n      if (component.functional) {\n        // register for functional component in vue file\n        var originalRender = component.render;\n\n        component.render = function renderWithStyleInjection(h, context) {\n          hook.call(context);\n          return originalRender(h, context);\n        };\n      } else {\n        // inject component registration as beforeCreate hook\n        var existing = component.beforeCreate;\n        component.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n      }\n    }\n  }\n  return component;\n}\n/* style inject */\n\n\nfunction __vue_create_injector__$2() {\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var styles = __vue_create_injector__$2.styles || (__vue_create_injector__$2.styles = {});\n  var isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\\\b/.test(navigator.userAgent.toLowerCase());\n  return function addStyle(id, css) {\n    if (document.querySelector('style[data-vue-ssr-id~=\"' + id + '\"]')) return; // SSR styles are present.\n\n    var group = isOldIE ? css.media || 'default' : id;\n    var style = styles[group] || (styles[group] = {\n      ids: [],\n      parts: [],\n      element: undefined\n    });\n\n    if (!style.ids.includes(id)) {\n      var code = css.source;\n      var _index3 = style.ids.length;\n      style.ids.push(id);\n\n      if (isOldIE) {\n        style.element = style.element || document.querySelector('style[data-group=' + group + ']');\n      }\n\n      if (!style.element) {\n        var el = style.element = document.createElement('style');\n        el.type = 'text/css';\n        if (css.media) el.setAttribute('media', css.media);\n\n        if (isOldIE) {\n          el.setAttribute('data-group', group);\n          el.setAttribute('data-next-index', '0');\n        }\n\n        head.appendChild(el);\n      }\n\n      if (isOldIE) {\n        _index3 = parseInt(style.element.getAttribute('data-next-index'));\n        style.element.setAttribute('data-next-index', _index3 + 1);\n      }\n\n      if (style.element.styleSheet) {\n        style.parts.push(code);\n        style.element.styleSheet.cssText = style.parts.filter(Boolean).join('\\n');\n      } else {\n        var textNode = document.createTextNode(code);\n        var nodes = style.element.childNodes;\n        if (nodes[_index3]) style.element.removeChild(nodes[_index3]);\n        if (nodes.length) style.element.insertBefore(textNode, nodes[_index3]);else style.element.appendChild(textNode);\n      }\n    }\n  };\n}\n/* style inject SSR */\n\n\nvar Menu = __vue_normalize__$2({\n  render: __vue_render__$2,\n  staticRenderFns: __vue_staticRenderFns__$2\n}, __vue_inject_styles__$2, __vue_script__$2, __vue_scope_id__$2, __vue_is_functional_template__$2, __vue_module_identifier__$2, __vue_create_injector__$2, undefined);\n\nvar _default = /*#__PURE__*/function () {\n  function _default(editor, props, vueComponent) {\n    _classCallCheck(this, _default);\n\n    var el = document.createElement('div');\n    editor.view.container.appendChild(el);\n    this.menu = new Vue({\n      render: function render(h) {\n        return h(vueComponent || Menu, {\n          props: props\n        });\n      }\n    }).$mount(el);\n  }\n\n  _createClass(_default, [{\n    key: \"addItem\",\n    value: function addItem() {\n      var _this$menu;\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      (_this$menu = this.menu).$emit.apply(_this$menu, ['additem'].concat(args));\n    }\n  }, {\n    key: \"show\",\n    value: function show() {\n      var _this$menu2;\n\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      (_this$menu2 = this.menu).$emit.apply(_this$menu2, ['show'].concat(args));\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.menu.$emit('hide');\n    }\n  }]);\n\n  return _default;\n}();\n\nvar MainMenu = /*#__PURE__*/function (_Menu) {\n  _inherits(MainMenu, _Menu);\n\n  function MainMenu(editor, props, vueComponent, _ref) {\n    var _this;\n\n    var items = _ref.items,\n        allocate = _ref.allocate,\n        rename = _ref.rename;\n\n    _classCallCheck(this, MainMenu);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MainMenu).call(this, editor, props, vueComponent));\n    var mouse = {\n      x: 0,\n      y: 0\n    };\n    editor.on('mousemove', function (_ref2) {\n      var x = _ref2.x,\n          y = _ref2.y;\n      mouse.x = x;\n      mouse.y = y;\n    });\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      var _loop = function _loop() {\n        var component = _step.value;\n        var path = allocate(component);\n\n        if (Array.isArray(path)) {\n          // add to the menu if path is array\n          _this.addItem(rename(component), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.t0 = editor;\n                    _context.next = 3;\n                    return createNode(component, mouse);\n\n                  case 3:\n                    _context.t1 = _context.sent;\n\n                    _context.t0.addNode.call(_context.t0, _context.t1);\n\n                  case 5:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, this);\n          })), path);\n        }\n      };\n\n      for (var _iterator = editor.components.values()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        _loop();\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    traverse(items, function (name, func, path) {\n      return _this.addItem(name, func, path);\n    });\n    return _this;\n  }\n\n  return MainMenu;\n}(_default);\n\nvar NodeMenu = /*#__PURE__*/function (_Menu) {\n  _inherits(NodeMenu, _Menu);\n\n  function NodeMenu(editor, props, vueComponent, nodeItems) {\n    var _this;\n\n    _classCallCheck(this, NodeMenu);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NodeMenu).call(this, editor, props, vueComponent));\n\n    if (nodeItems['Delete'] !== false) {\n      _this.addItem('Delete', function (_ref) {\n        var node = _ref.node;\n        return editor.removeNode(node);\n      });\n    }\n\n    if (nodeItems['Clone'] !== false) {\n      _this.addItem('Clone', /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(args) {\n          var _args$node, name, _args$node$position, x, y, params, component, node;\n\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _args$node = args.node, name = _args$node.name, _args$node$position = _slicedToArray(_args$node.position, 2), x = _args$node$position[0], y = _args$node$position[1], params = _objectWithoutProperties(_args$node, [\"name\", \"position\"]);\n                  component = editor.components.get(name);\n                  _context.next = 4;\n                  return createNode(component, _objectSpread({}, params, {\n                    x: x + 10,\n                    y: y + 10\n                  }));\n\n                case 4:\n                  node = _context.sent;\n                  editor.addNode(node);\n\n                case 6:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        return function (_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    }\n\n    traverse(nodeItems, function (name, func, path) {\n      return _this.addItem(name, func, path);\n    });\n    return _this;\n  }\n\n  return NodeMenu;\n}(_default);\n\nfunction install(editor, _ref) {\n  var _ref$searchBar = _ref.searchBar,\n      searchBar = _ref$searchBar === void 0 ? true : _ref$searchBar,\n      _ref$searchKeep = _ref.searchKeep,\n      searchKeep = _ref$searchKeep === void 0 ? function () {\n    return false;\n  } : _ref$searchKeep,\n      _ref$delay = _ref.delay,\n      delay = _ref$delay === void 0 ? 1000 : _ref$delay,\n      _ref$items = _ref.items,\n      items = _ref$items === void 0 ? {} : _ref$items,\n      _ref$nodeItems = _ref.nodeItems,\n      nodeItems = _ref$nodeItems === void 0 ? {} : _ref$nodeItems,\n      _ref$allocate = _ref.allocate,\n      allocate = _ref$allocate === void 0 ? function () {\n    return [];\n  } : _ref$allocate,\n      _ref$rename = _ref.rename,\n      rename = _ref$rename === void 0 ? function (component) {\n    return component.name;\n  } : _ref$rename,\n      _ref$vueComponent = _ref.vueComponent,\n      vueComponent = _ref$vueComponent === void 0 ? null : _ref$vueComponent;\n  editor.bind('hidecontextmenu');\n  editor.bind('showcontextmenu');\n  var menu = null;\n  editor.on('hidecontextmenu', function () {\n    if (menu) menu.hide();\n  });\n  editor.on('click contextmenu', function () {\n    editor.trigger('hidecontextmenu');\n  });\n  editor.on('contextmenu', function (_ref2) {\n    var e = _ref2.e,\n        node = _ref2.node;\n    e.preventDefault();\n    e.stopPropagation();\n    if (!editor.trigger('showcontextmenu', {\n      e: e,\n      node: node\n    })) return;\n    var _ref3 = [e.clientX, e.clientY],\n        x = _ref3[0],\n        y = _ref3[1];\n\n    if (node) {\n      menu = new NodeMenu(editor, {\n        searchBar: false,\n        delay: delay\n      }, vueComponent, isFunction(nodeItems) ? nodeItems(node) : nodeItems);\n      menu.show(x, y, {\n        node: node\n      });\n    } else {\n      menu = new MainMenu(editor, {\n        searchBar: searchBar,\n        searchKeep: searchKeep,\n        delay: delay\n      }, vueComponent, {\n        items: items,\n        allocate: allocate,\n        rename: rename\n      });\n      menu.show(x, y);\n    }\n  });\n}\n\nvar Menu$1 = Menu;\nvar Item$1 = Item;\nvar Search$1 = Search;\nvar index = {\n  name: 'context-menu',\n  install: install\n};\nexport default index;\nexport { Menu$1 as Menu, Item$1 as Item, Search$1 as Search };","map":{"version":3,"sources":["../src/utils.js","../src/menu/debounceHide.js","../src/menu/Item.vue","../src/menu/Search.vue","../src/menu/Menu.vue","../src/menu/index.js","../src/main-menu.js","../src/node-menu.js","../src/index.js"],"names":["JSON","data","meta","x","y","node","component","deepCopy","Object","path","items","callback","traverse","Math","window","element","props","delay","type","required","timeoutHide","methods","cancelHide","hide","mounted","debounce","el","document","editor","render","h","vueComponent","args","MainMenu","Menu","allocate","rename","mouse","Array","createNode","NodeMenu","nodeItems","name","params","searchBar","searchKeep","menu","e","isFunction","VueMenu","Item","VueItem","Search","VueSearch","install"],"mappings":"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","sourcesContent":["export function deepCopy(obj) {\n    return JSON.parse(JSON.stringify(obj));\n}\n\nexport async function createNode(component, { data = {}, meta = {}, x = 0, y = 0 }) {\n    const node = await component.createNode(deepCopy(data));\n\n    node.meta = Object.assign(deepCopy(meta), node.meta);\n    node.position[0] = x;\n    node.position[1] = y;\n    \n    return node;\n}\n\nexport function traverse(items, callback, path = []) {\n    if (typeof items !== 'object') return;\n\n    Object.keys(items).map(key => {\n        if (typeof items[key] === 'function')\n            callback(key, items[key], path)\n        else \n            traverse(items[key], callback, [...path, key])\n    })\n}\n\nexport function fitViewport([x, y], element) {\n    return [\n        Math.min(x, window.innerWidth - element.clientWidth),\n        Math.min(y, window.innerHeight - element.clientHeight)\n    ]\n}","import { debounce } from 'lodash-es';\n\nexport default (hideMethod) => ({\n    props: { delay: { type: Number, required: true } },\n    data() {\n        return {\n            timeoutHide: () => {}\n        }\n    },\n    methods: {\n        cancelHide() {\n            const hide = this.timeoutHide;\n    \n            if (hide && hide.cancel)\n                this.timeoutHide.cancel();\n        }\n    },\n    mounted() {\n        this.timeoutHide = debounce(this[hideMethod], this.delay);\n    }\n})","<template lang=\"pug\">\n.item(\n  @click=\"onClick($event)\"\n  @mouseover=\"showSubitems()\"\n  @mouseleave=\"timeoutHide()\"\n  :class=\"{ hasSubitems }\"\n) {{item.title}}\n  .subitems(v-show=\"hasSubitems && this.visibleSubitems\")\n    Item(v-for=\"subitem in item.subitems\"\n      :key=\"subitem.title\"\n      :item=\"subitem\"\n      :args=\"args\"\n      :delay=\"delay\"\n      )\n</template>\n\n<script>\nimport hideMixin from './debounceHide'\n\nexport default {\n  name: 'Item',\n  mixins: [hideMixin('hideSubitems')],\n  props: { item: Object, args: Object },\n  data() {\n    return {\n      visibleSubitems: false, \n    }\n  },\n  computed: {\n    hasSubitems() {\n      return this.item.subitems\n    }\n  },\n  methods: {\n    showSubitems() {\n      this.visibleSubitems = true;\n      this.cancelHide();\n    },\n    hideSubitems() {\n      this.visibleSubitems = false;\n    },\n    onClick(e) {\n      e.stopPropagation();\n      \n      if(this.item.onClick)\n        this.item.onClick(this.args);\n      this.$root.$emit('hide');\n    }\n  }\n}\n</script>\n\n\n<style lang=\"sass\" scoped>\n@import '../vars.sass'\n@import '../common.sass'\n\n.item\n  @extend .item\n  &.hasSubitems:after\n    content: '►'\n    position: absolute\n    opacity: 0.6\n    right: 5px\n    top: 5px\n  .subitems\n    position: absolute\n    top: 0\n    left: 100%\n    width: $width\n    .subitem\n      @extend .item\n</style>\n","<template lang=\"pug\">\n.search\n  input(v-model=\"value\")\n</template>\n\n<script>\nexport default {\n  props: ['value', 'search'],\n  watch: {\n    value() {\n      this.$emit('search', this.value);\n    }\n  }\n}\n</script>\n\n\n<style lang=\"sass\" scoped>\n.search\n  input    \n    color: white\n    padding: 1px 8px\n    border: 1px solid white\n    border-radius: 10px\n    font-size: 16px\n    font-family: serif\n    width: 100%\n    box-sizing: border-box\n    background: transparent\n</style>\n","<template lang=\"pug\">\n.context-menu(\n  ref=\"menu\"\n  v-if=\"visible\"\n  v-bind:style=\"style\",\n  @mouseleave='timeoutHide()',\n  @mouseover=\"cancelHide()\"\n  @contextmenu.prevent=\"\"\n  @wheel.stop=\"\"\n)\n  Search(v-if=\"searchBar\", v-model=\"filter\", @search=\"onSearch\")\n  Item(v-for='item in filtered'\n    :key=\"item.title\"\n    :item=\"item\"\n    :args=\"args\"\n    :delay=\"delay / 2\"\n  )\n</template>\n\n<script>\nimport hideMixin from './debounceHide'\nimport Item from './Item.vue';\nimport Search from './Search.vue';\nimport { fitViewport } from '../utils';\n\nexport default {\n  props: { searchBar: Boolean, searchKeep: Function },\n  mixins: [hideMixin('hide')],\n  data() {\n    return {\n      x: 0,\n      y: 0,\n      visible: false,\n      args: {},\n      filter: '',\n      items: [],\n    }\n  },\n  computed: {\n    style() {\n      return {\n        top: this.y+'px', \n        left: this.x+'px'\n      }\n    },\n    filtered() {\n      if(!this.filter) return this.items;\n      const regex = new RegExp(this.filter, 'i');\n      \n      return this.extractLeafs(this.items)\n        .filter(({ title }) => {\n          return this.searchKeep(title) || title.match(regex)\n        });\n    }\n  },\n  methods: {\n    extractLeafs(items) {\n      if(!items) return [];\n      let leafs = [];\n      items.map(item => {\n        if(!item.subitems) leafs.push(item)\n\n        leafs.push(...this.extractLeafs(item.subitems))\n      })\n\n      return leafs;\n    },\n    onSearch(e) {\n      this.filter = e;\n    },\n    show(x, y, args = {}) {\n      this.visible = true;\n      this.x = x;\n      this.y = y;\n      this.args = args;\n  \n      this.cancelHide();\n    },\n    hide() {\n      this.visible = false;\n    },\n    additem(title, onClick, path = []) {\n      let items = this.items;\n      for(let level of path) {\n        let exist = items.find(i => i.title === level);\n\n        if(!exist) {\n          exist = { title: level, subitems: [] };\n          items.push(exist)\n        }\n\n        items = exist.subitems || (exist.subitems = []);\n      }\n\n      items.push({ title, onClick });\n    },\n  },\n  updated() {\n    if(this.$refs.menu) {\n      [this.x, this.y] = fitViewport([this.x, this.y], this.$refs.menu)\n    } \n  },\n  mounted() {\n    this.$root.$on('show', this.show);\n    this.$root.$on('hide', this.hide);\n    this.$root.$on('additem', this.additem);\n  },\n  components: {\n    Item,\n    Search\n  }\n}\n</script>\n\n\n<style lang=\"sass\" scoped>\n@import '../vars.sass'\n@import '../common.sass'\n\n.context-menu\n  left: 0\n  top: 0\n  position: fixed\n  padding: 10px\n  width: $width\n  margin-top: -20px\n  margin-left: -$width/2\n  .search\n    @extend .item\n</style>\n","import Menu from './Menu.vue';\nimport Vue from 'vue';\n\nexport default class {\n    \n    constructor(editor, props, vueComponent) {\n        const el = document.createElement('div');\n\n        editor.view.container.appendChild(el);\n\n        this.menu = new Vue({\n            render: h => h(vueComponent || Menu, { props })\n        }).$mount(el);\n    }\n\n    addItem(...args) {\n        this.menu.$emit('additem', ...args);\n    }\n\n    show(...args) {\n        this.menu.$emit('show', ...args);\n    }\n\n    hide() {\n        this.menu.$emit('hide');\n    }\n}","import { createNode, traverse } from './utils';\nimport Menu from './menu/index';\n\nexport default class MainMenu extends Menu {\n    constructor(editor, props, vueComponent, { items, allocate, rename }) {\n        super(editor, props, vueComponent);\n        \n        const mouse = { x: 0, y: 0 };\n\n        editor.on('mousemove', ({ x, y }) => {\n            mouse.x = x;\n            mouse.y = y;\n        });\n        \n        for(const component of editor.components.values()) {\n            const path = allocate(component);\n    \n            if (Array.isArray(path)) { // add to the menu if path is array\n                this.addItem(rename(component), async () => {\n                    editor.addNode(await createNode(component, mouse));\n                }, path);\n            }\n        }\n    \n        traverse(items, (name, func, path) => this.addItem(name, func, path))\n    }\n}","import Menu from './menu/index';\nimport { createNode, traverse } from './utils';\n\nexport default class NodeMenu extends Menu {\n    constructor(editor, props, vueComponent, nodeItems) {\n        super(editor, props, vueComponent);\n\n        if (nodeItems['Delete'] !== false) {\n            this.addItem('Delete', ({ node }) => editor.removeNode(node));\n        }\n        if (nodeItems['Clone'] !== false) {\n            this.addItem('Clone', async (args) => {\n                const { name, position: [x, y], ...params } = args.node;\n                const component = editor.components.get(name);\n                const node = await createNode(component, { ...params, x: x + 10, y: y + 10 });\n\n                editor.addNode(node);\n            });\n        }\n\n        traverse(nodeItems, (name, func, path) => this.addItem(name, func, path))\n    }\n}\n","import MainMenu from './main-menu';\nimport NodeMenu from './node-menu';\nimport VueItem from './menu/Item.vue';\nimport VueMenu from './menu/Menu.vue';\nimport VueSearch from './menu/Search.vue';\nimport { isFunction } from 'lodash-es';\n\nfunction install(editor, {\n    searchBar = true,\n    searchKeep = () => false,\n    delay = 1000,\n    items = {},\n    nodeItems = {},\n    allocate = () => [],\n    rename = component => component.name,\n    vueComponent = null\n}) {\n    editor.bind('hidecontextmenu');\n    editor.bind('showcontextmenu');\n\n    let menu = null;\n\n    editor.on('hidecontextmenu', () => {\n        if (menu) menu.hide();\n    });\n\n    editor.on('click contextmenu', () => {\n        editor.trigger('hidecontextmenu');\n    });\n\n    editor.on('contextmenu', ({ e, node }) => {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (!editor.trigger('showcontextmenu', { e, node })) return;\n\n        const [x, y] = [e.clientX, e.clientY];\n\n        if(node) {\n            menu = new NodeMenu(editor, { searchBar: false, delay }, vueComponent,  isFunction(nodeItems) ? nodeItems(node) : nodeItems);\n            menu.show(x, y, { node });\n        } else {\n            menu = new MainMenu(editor, { searchBar, searchKeep, delay }, vueComponent, { items, allocate, rename });\n            menu.show(x, y);\n        }\n    });\n}\n\nexport const Menu = VueMenu;\nexport const Item = VueItem;\nexport const Search = VueSearch;\n\nexport default {\n    name: 'context-menu',\n    install\n}\n"]},"metadata":{},"sourceType":"module"}